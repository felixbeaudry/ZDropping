simAlleleFreq[frqYr==year & frqCat=='pMi',c(3:(nloci+2))]
simAlleleFreq[frqYr==year & frqCat=='errFI',c(3:(nloci+2))]<-
simAlleleFreq[frqYr==year & frqCat=='xFi',c(3:(nloci+2))]-
simAlleleFreq[frqYr==year & frqCat=='pFi',c(3:(nloci+2))]
simAlleleFreq[frqYr==year & frqCat=='errMB',c(3:(nloci+2))]<-
simAlleleFreq[frqYr==year & frqCat=='xMb',c(3:(nloci+2))]-
simAlleleFreq[frqYr==year & frqCat=='pMb',c(3:(nloci+2))]
simAlleleFreq[frqYr==year & frqCat=='errFB',c(3:(nloci+2))]<-
simAlleleFreq[frqYr==year & frqCat=='xFb',c(3:(nloci+2))]-
simAlleleFreq[frqYr==year & frqCat=='pFb',c(3:(nloci+2))]
#mom
simAlleleFreq[frqYr==year & frqCat=='errMmom',c(3:(nloci+2))]<-
simAlleleFreq[frqYr==year & frqCat=='xMmom',c(3:(nloci+2))]-
simAlleleFreq[frqYr==year & frqCat=='pMmom',c(3:(nloci+2))]
#simAlleleFreq[frqYr==year & frqCat=='pMmom',c(3:(10+2))]
#
simAlleleFreq[frqYr==year & frqCat=='errFmom',c(3:(nloci+2))]<-
simAlleleFreq[frqYr==year & frqCat=='xFmom',c(3:(nloci+2))]-
simAlleleFreq[frqYr==year & frqCat=='pFmom',c(3:(nloci+2))]
#dad
simAlleleFreq[frqYr==year & frqCat=='errMdad',c(3:(nloci+2))]<-
simAlleleFreq[frqYr==year & frqCat=='xMdad',c(3:(nloci+2))]-
simAlleleFreq[frqYr==year & frqCat=='pMdad',c(3:(nloci+2))]
simAlleleFreq[frqYr==year & frqCat=='errFdad',c(3:(nloci+2))]<-
simAlleleFreq[frqYr==year & frqCat=='xFdad',c(3:(nloci+2))]-
simAlleleFreq[frqYr==year & frqCat=='pFdad',c(3:(nloci+2))]
#allele freq differences
#true (population) freq (p)
#this is actually doing pt - pt-1 even thought the category name is pt1-pt
#so the math does match my equations
simAlleleFreq[frqYr==year & frqCat=='pt1-pt',c(3:(nloci+2))]<-
simAlleleFreq[frqYr==year & frqCat=='pt',c(3:(nloci+2))]-
simAlleleFreq[frqYr==(year-1) & frqCat=='pt',c(3:(nloci+2))]
simAlleleFreq[frqYr==year & frqCat=='pMs-pt',c(3:(nloci+2))]<-
simAlleleFreq[frqYr==year & frqCat=='pMs',c(3:(nloci+2))]-
simAlleleFreq[frqYr==(year-1) & frqCat=='pt',c(3:(nloci+2))]
simAlleleFreq[frqYr==year & frqCat=='pFs-pt',c(3:(nloci+2))]<-
simAlleleFreq[frqYr==year & frqCat=='pFs',c(3:(nloci+2))]-
simAlleleFreq[frqYr==(year-1) & frqCat=='pt',c(3:(nloci+2))]
simAlleleFreq[frqYr==year & frqCat=='pMi-pt',c(3:(nloci+2))]<-
simAlleleFreq[frqYr==year & frqCat=='pMi',c(3:(nloci+2))]-
simAlleleFreq[frqYr==(year-1) & frqCat=='pt',c(3:(nloci+2))]
simAlleleFreq[frqYr==year & frqCat=='pFi-pt',c(3:(nloci+2))]<-
simAlleleFreq[frqYr==year & frqCat=='pFi',c(3:(nloci+2))]-
simAlleleFreq[frqYr==(year-1) & frqCat=='pt',c(3:(nloci+2))]
simAlleleFreq[frqYr==year & frqCat=='pMb-pt',c(3:(nloci+2))]<-
simAlleleFreq[frqYr==year & frqCat=='pMb',c(3:(nloci+2))]-
simAlleleFreq[frqYr==(year-1) & frqCat=='pt',c(3:(nloci+2))]
simAlleleFreq[frqYr==year & frqCat=='pFb-pt',c(3:(nloci+2))]<-
simAlleleFreq[frqYr==year & frqCat=='pFb',c(3:(nloci+2))]-
simAlleleFreq[frqYr==(year-1) & frqCat=='pt',c(3:(nloci+2))]
#sample freq (x)
simAlleleFreq[frqYr==year & frqCat=='xt1-xt',c(3:(nloci+2))]<-
simAlleleFreq[frqYr==year & frqCat=='xt',c(3:(nloci+2))]-
simAlleleFreq[frqYr==(year-1) & frqCat=='xt',c(3:(nloci+2))]
simAlleleFreq[frqYr==year & frqCat=='xMs-xt',c(3:(nloci+2))]<-
simAlleleFreq[frqYr==year & frqCat=='xMs',c(3:(nloci+2))]-
simAlleleFreq[frqYr==(year-1) & frqCat=='xt',c(3:(nloci+2))]
simAlleleFreq[frqYr==year & frqCat=='xFs-xt',c(3:(nloci+2))]<-
simAlleleFreq[frqYr==year & frqCat=='xFs',c(3:(nloci+2))]-
simAlleleFreq[frqYr==(year-1) & frqCat=='xt',c(3:(nloci+2))]
simAlleleFreq[frqYr==year & frqCat=='xMi-xt',c(3:(nloci+2))]<-
simAlleleFreq[frqYr==year & frqCat=='xMi',c(3:(nloci+2))]-
simAlleleFreq[frqYr==(year-1) & frqCat=='xt',c(3:(nloci+2))]
simAlleleFreq[frqYr==year & frqCat=='xFi-xt',c(3:(nloci+2))]<-
simAlleleFreq[frqYr==year & frqCat=='xFi',c(3:(nloci+2))]-
simAlleleFreq[frqYr==(year-1) & frqCat=='xt',c(3:(nloci+2))]
simAlleleFreq[frqYr==year & frqCat=='xMb-xt',c(3:(nloci+2))]<-
simAlleleFreq[frqYr==year & frqCat=='xMb',c(3:(nloci+2))]-
simAlleleFreq[frqYr==(year-1) & frqCat=='xt',c(3:(nloci+2))]
simAlleleFreq[frqYr==year & frqCat=='xFb-xt',c(3:(nloci+2))]<-
simAlleleFreq[frqYr==year & frqCat=='xFb',c(3:(nloci+2))]-
simAlleleFreq[frqYr==(year-1) & frqCat=='xt',c(3:(nloci+2))]
#true errors
simAlleleFreq[frqYr==year & frqCat=='errt1-errt',c(3:(nloci+2))]<-
simAlleleFreq[frqYr==year & frqCat=='errT',c(3:(nloci+2))]-
simAlleleFreq[frqYr==(year-1) & frqCat=='errT',c(3:(nloci+2))]
simAlleleFreq[frqYr==year & frqCat=='errMS-errT',c(3:(nloci+2))]<-
simAlleleFreq[frqYr==year & frqCat=='errMS',c(3:(nloci+2))]-
simAlleleFreq[frqYr==(year-1) & frqCat=='errT',c(3:(nloci+2))]
simAlleleFreq[frqYr==year & frqCat=='errFS-errT',c(3:(nloci+2))]<-
simAlleleFreq[frqYr==year & frqCat=='errFS',c(3:(nloci+2))]-
simAlleleFreq[frqYr==(year-1) & frqCat=='errT',c(3:(nloci+2))]
simAlleleFreq[frqYr==year & frqCat=='errMI-errT',c(3:(nloci+2))]<-
simAlleleFreq[frqYr==year & frqCat=='errMI',c(3:(nloci+2))]-
simAlleleFreq[frqYr==(year-1) & frqCat=='errT',c(3:(nloci+2))]
simAlleleFreq[frqYr==year & frqCat=='errFI-errT',c(3:(nloci+2))]<-
simAlleleFreq[frqYr==year & frqCat=='errFI',c(3:(nloci+2))]-
simAlleleFreq[frqYr==(year-1) & frqCat=='errT',c(3:(nloci+2))]
simAlleleFreq[frqYr==year & frqCat=='errMB-errT',c(3:(nloci+2))]<-
simAlleleFreq[frqYr==year & frqCat=='errMB',c(3:(nloci+2))]-
simAlleleFreq[frqYr==(year-1) & frqCat=='errT',c(3:(nloci+2))]
simAlleleFreq[frqYr==year & frqCat=='errFB-errT',c(3:(nloci+2))]<-
simAlleleFreq[frqYr==year & frqCat=='errFB',c(3:(nloci+2))]-
simAlleleFreq[frqYr==(year-1) & frqCat=='errT',c(3:(nloci+2))]
#Mendelian noise
simAlleleFreq[frqYr==year & frqCat=='pMfam',c(3:(nloci+2))]<-
0.5*(simAlleleFreq[frqYr==year & frqCat=='pMmom',c(3:(nloci+2))]+
simAlleleFreq[frqYr==year & frqCat=='pMdad',c(3:(nloci+2))])
simAlleleFreq[frqYr==year & frqCat=='pFfam',c(3:(nloci+2))]<-
0.5*(simAlleleFreq[frqYr==year & frqCat=='pFmom',c(3:(nloci+2))]+
simAlleleFreq[frqYr==year & frqCat=='pFdad',c(3:(nloci+2))])
simAlleleFreq[frqYr==year & frqCat=='pMmend',c(3:(nloci+2))]<-
simAlleleFreq[frqYr==year & frqCat=='pMb',c(3:(nloci+2))]-
simAlleleFreq[frqYr==year & frqCat=='pMfam',c(3:(nloci+2))]
simAlleleFreq[frqYr==year & frqCat=='pFmend',c(3:(nloci+2))]<-
simAlleleFreq[frqYr==year & frqCat=='pFb',c(3:(nloci+2))]-
simAlleleFreq[frqYr==year & frqCat=='pFfam',c(3:(nloci+2))]
simAlleleFreq[frqYr==year & frqCat=='pMfam-pt',c(3:(nloci+2))]<-
simAlleleFreq[frqYr==year & frqCat=='pMfam',c(3:(nloci+2))]-
simAlleleFreq[frqYr==(year-1) & frqCat=='pt',c(3:(nloci+2))]
simAlleleFreq[frqYr==year & frqCat=='pFfam-pt',c(3:(nloci+2))]<-
simAlleleFreq[frqYr==year & frqCat=='pFfam',c(3:(nloci+2))]-
simAlleleFreq[frqYr==(year-1) & frqCat=='pt',c(3:(nloci+2))]
simAlleleFreq[frqYr==year & frqCat=='xMfam',c(3:(nloci+2))]<-
0.5*(simAlleleFreq[frqYr==year & frqCat=='xMmom',c(3:(nloci+2))]+
simAlleleFreq[frqYr==year & frqCat=='xMdad',c(3:(nloci+2))])
simAlleleFreq[frqYr==year & frqCat=='xFfam',c(3:(nloci+2))]<-
0.5*(simAlleleFreq[frqYr==year & frqCat=='xFmom',c(3:(nloci+2))]+
simAlleleFreq[frqYr==year & frqCat=='xFdad',c(3:(nloci+2))])
simAlleleFreq[frqYr==year & frqCat=='xMmend',c(3:(nloci+2))]<-
simAlleleFreq[frqYr==year & frqCat=='xMb',c(3:(nloci+2))]-
simAlleleFreq[frqYr==year & frqCat=='xMfam',c(3:(nloci+2))]
simAlleleFreq[frqYr==year & frqCat=='xFmend',c(3:(nloci+2))]<-
simAlleleFreq[frqYr==year & frqCat=='xFb',c(3:(nloci+2))]-
simAlleleFreq[frqYr==year & frqCat=='xFfam',c(3:(nloci+2))]
simAlleleFreq[frqYr==year & frqCat=='xMfam-xt',c(3:(nloci+2))]<-
simAlleleFreq[frqYr==year & frqCat=='xMfam',c(3:(nloci+2))]-
simAlleleFreq[frqYr==(year-1) & frqCat=='xt',c(3:(nloci+2))]
simAlleleFreq[frqYr==year & frqCat=='xFfam-xt',c(3:(nloci+2))]<-
simAlleleFreq[frqYr==year & frqCat=='xFfam',c(3:(nloci+2))]-
simAlleleFreq[frqYr==(year-1) & frqCat=='xt',c(3:(nloci+2))]
simAlleleFreq[frqYr==year & frqCat=='errMFAM',c(3:(nloci+2))]<-
0.5*(simAlleleFreq[frqYr==year & frqCat=='errMmom',c(3:(nloci+2))]+
simAlleleFreq[frqYr==year & frqCat=='errMdad',c(3:(nloci+2))])
simAlleleFreq[frqYr==year & frqCat=='errFFAM',c(3:(nloci+2))]<-
0.5*(simAlleleFreq[frqYr==year & frqCat=='errFmom',c(3:(nloci+2))]+
simAlleleFreq[frqYr==year & frqCat=='errFdad',c(3:(nloci+2))])
simAlleleFreq[frqYr==year & frqCat=='errMMEND',c(3:(nloci+2))]<-
simAlleleFreq[frqYr==year & frqCat=='errMB',c(3:(nloci+2))]-
simAlleleFreq[frqYr==year & frqCat=='errMFAM',c(3:(nloci+2))]
simAlleleFreq[frqYr==year & frqCat=='errFMEND',c(3:(nloci+2))]<-
simAlleleFreq[frqYr==year & frqCat=='errFB',c(3:(nloci+2))]-
simAlleleFreq[frqYr==year & frqCat=='errFFAM',c(3:(nloci+2))]
simAlleleFreq[frqYr==year & frqCat=='errMFAM-errT',c(3:(nloci+2))]<-
simAlleleFreq[frqYr==year & frqCat=='errMFAM',c(3:(nloci+2))]-
simAlleleFreq[frqYr==(year-1) & frqCat=='errT',c(3:(nloci+2))]
simAlleleFreq[frqYr==year & frqCat=='errFFAM-errT',c(3:(nloci+2))]<-
simAlleleFreq[frqYr==year & frqCat=='errFFAM',c(3:(nloci+2))]-
simAlleleFreq[frqYr==(year-1) & frqCat=='errT',c(3:(nloci+2))]
}
save(simAlleleFreq,file="working_files/intermediate_files/simAlleleFreqA.rdata")
#load("simAlleleFreqA_11Mar2021.rdata")
####calculate variances and covariances####
simVar<-data.frame(Year=rep(c(1999:2013),each=114),Category=rep(c(
'pt1-pt','xt1-xt', 'errt1-errt',
'pMs-pt','xMs-xt','errMS-errT','pMspterrMSerrT',
'pFs-pt','xFs-xt','errFS-errT','pFspterrFSerrT',
'pMi-pt','xMi-xt','errMI-errT','pMipterrMIerrT',
'pFi-pt','xFi-xt','errFI-errT','pFipterrFIerrT',
'pMb-pt','xMb-xt','errMB-errT','pMbpterrMBerrT',
'pFb-pt','xFb-xt','errFB-errT','pFbpterrFBerrT',
'pMspMi','xMsxMi','xMserrMI','errMSxMi','errMSerrMI',
'pMspMb','xMsxMb','xMserrMB','errMSxMb','errMSerrMB',
'pMipMb','xMixMb','xMierrMB','errMIxMb','errMIerrMB',
'pFspFi','xFsxFi','xFserrFI','errFSxFi','errFSerrFI',
'pFspFb','xFsxFb','xFserrFB','errFSxFb','errFSerrFB',
'pFipFb','xFixFb','xFierrFB','errFIxFb','errFIerrFB',
'pMspFs','xMsxFs','xMserrFS','errMSxFs','errMSerrFS',
'pMipFi','xMixFi','xMierrFI','errMIxFi','errMIerrFI',
'pMbpFb','xMbxFb','xMberrFB','errMBxFb','errMBerrFB',
'pMspFi','xMsxFi','xMserrFI','errMSxFi','errMSerrFI',
'pMspFb','xMsxFb','xMserrFB','errMSxFb','errMSerrFB',
'pMipFb','xMixFb','xMierrFB','errMIxFb','errMIerrFB',
'pFspMi','xFsxMi','xFserrMI','errFSxMi','errFSerrMI',
'pFspMb','xFsxMb','xFserrMB','errFSxMb','errFSerrMB',
'pFipMb','xFixMb','xFierrMB','errFIxMb','errFIerrMB',
'pMmend','xMmend','errMMEND','pMfam-pt','xMfam-xt','errMFAM-errT',
'pFmend','xFmend','errFMEND','pFfam-pt','xFfam-xt','errFFAM-errT')
,15),stringsAsFactors=FALSE)
bsYr<-simVar$Year
bsCat<-simVar$Category
#year=1999
for(year in c(1999:2013)){
#total variance, for males and females
simVar[bsYr==year & bsCat=='pt1-pt',3]<-
mean(as.numeric(simAlleleFreq[frqYr==year & frqCat=='pt1-pt',c(3:(nloci+2))])^2)
simVar[bsYr==year & bsCat=='xt1-xt',3]<-
mean(as.numeric(simAlleleFreq[frqYr==year & frqCat=='xt1-xt',c(3:(nloci+2))])^2)
simVar[bsYr==year & bsCat=='errt1-errt',3]<-
mean(as.numeric(simAlleleFreq[frqYr==year & frqCat=='errt1-errt',c(3:(nloci+2))])^2)
#variance for each category, for males and females
#survivors
simVar[bsYr==year & bsCat=='pMs-pt',3]<-
mean(as.numeric(simAlleleFreq[frqYr==year & frqCat=='pMs-pt',c(3:(nloci+2))])^2)
simVar[bsYr==year & bsCat=='xMs-xt',3]<-
mean(as.numeric(simAlleleFreq[frqYr==year & frqCat=='xMs-xt',c(3:(nloci+2))])^2)
simVar[bsYr==year & bsCat=='errMS-errT',3]<-
mean(as.numeric(simAlleleFreq[frqYr==year & frqCat=='errMS-errT',c(3:(nloci+2))])^2)
simVar[bsYr==year & bsCat=='pMspterrMSerrT',3]<-
mean(as.numeric(simAlleleFreq[frqYr==year & frqCat=='pMs-pt',c(3:(nloci+2))])*
as.numeric(simAlleleFreq[frqYr==year & frqCat=='errMS-errT',c(3:(nloci+2))]))
simVar[bsYr==year & bsCat=='pFs-pt',3]<-
mean(as.numeric(simAlleleFreq[frqYr==year & frqCat=='pFs-pt',c(3:(nloci+2))])^2)
simVar[bsYr==year & bsCat=='xFs-xt',3]<-
mean(as.numeric(simAlleleFreq[frqYr==year & frqCat=='xFs-xt',c(3:(nloci+2))])^2)
simVar[bsYr==year & bsCat=='errFS-errT',3]<-
mean(as.numeric(simAlleleFreq[frqYr==year & frqCat=='errFS-errT',c(3:(nloci+2))])^2)
simVar[bsYr==year & bsCat=='pFspterrFSerrT',3]<-
mean(as.numeric(simAlleleFreq[frqYr==year & frqCat=='pFs-pt',c(3:(nloci+2))])*
as.numeric(simAlleleFreq[frqYr==year & frqCat=='errFS-errT',c(3:(nloci+2))]))
#imms
simVar[bsYr==year & bsCat=='pMi-pt',3]<-
mean(as.numeric(simAlleleFreq[frqYr==year & frqCat=='pMi-pt',c(3:(nloci+2))])^2)
simVar[bsYr==year & bsCat=='xMi-xt',3]<-
mean(as.numeric(simAlleleFreq[frqYr==year & frqCat=='xMi-xt',c(3:(nloci+2))])^2)
simVar[bsYr==year & bsCat=='errMI-errT',3]<-
mean(as.numeric(simAlleleFreq[frqYr==year & frqCat=='errMI-errT',c(3:(nloci+2))])^2)
simVar[bsYr==year & bsCat=='pMipterrMIerrT',3]<-
mean(as.numeric(simAlleleFreq[frqYr==year & frqCat=='pMi-pt',c(3:(nloci+2))])*
as.numeric(simAlleleFreq[frqYr==year & frqCat=='errMI-errT',c(3:(nloci+2))]))
simVar[bsYr==year & bsCat=='pFi-pt',3]<-
mean(as.numeric(simAlleleFreq[frqYr==year & frqCat=='pFi-pt',c(3:(nloci+2))])^2)
simVar[bsYr==year & bsCat=='xFi-xt',3]<-
mean(as.numeric(simAlleleFreq[frqYr==year & frqCat=='xFi-xt',3:(nloci+2)])^2)
simVar[bsYr==year & bsCat=='errFI-errT',3]<-
mean(as.numeric(simAlleleFreq[frqYr==year & frqCat=='errFI-errT',c(3:(nloci+2))])^2)
simVar[bsYr==year & bsCat=='pFipterrFIerrT',3]<-
mean(as.numeric(simAlleleFreq[frqYr==year & frqCat=='pFi-pt',c(3:(nloci+2))])*
as.numeric(simAlleleFreq[frqYr==year & frqCat=='errFI-errT',c(3:(nloci+2))]))
#births
simVar[bsYr==year & bsCat=='pMb-pt',3]<-
mean(as.numeric(simAlleleFreq[frqYr==year & frqCat=='pMb-pt',c(3:(nloci+2))])^2)
simVar[bsYr==year & bsCat=='xMb-xt',3]<-
mean(as.numeric(simAlleleFreq[frqYr==year & frqCat=='xMb-xt',c(3:(nloci+2))])^2)
simVar[bsYr==year & bsCat=='errMB-errT',3]<-
mean(as.numeric(simAlleleFreq[frqYr==year & frqCat=='errMB-errT',c(3:(nloci+2))])^2)
simVar[bsYr==year & bsCat=='pMbpterrMBerrT',3]<-
mean(as.numeric(simAlleleFreq[frqYr==year & frqCat=='pMb-pt',c(3:(nloci+2))])*
as.numeric(simAlleleFreq[frqYr==year & frqCat=='errMB-errT',c(3:(nloci+2))]))
simVar[bsYr==year & bsCat=='pFb-pt',3]<-
mean(as.numeric(simAlleleFreq[frqYr==year & frqCat=='pFb-pt',c(3:(nloci+2))])^2)
simVar[bsYr==year & bsCat=='xFb-xt',3]<-
mean(as.numeric(simAlleleFreq[frqYr==year & frqCat=='xFb-xt',c(3:(nloci+2))])^2)
simVar[bsYr==year & bsCat=='errFB-errT',3]<-
mean(as.numeric(simAlleleFreq[frqYr==year & frqCat=='errFB-errT',c(3:(nloci+2))])^2)
simVar[bsYr==year & bsCat=='pFbpterrFBerrT',3]<-
mean(as.numeric(simAlleleFreq[frqYr==year & frqCat=='pFb-pt',c(3:(nloci+2))])*
as.numeric(simAlleleFreq[frqYr==year & frqCat=='errFB-errT',c(3:(nloci+2))]))
#covariance between categories - males
simVar[bsYr==year & bsCat=='pMspMi',3]<-
mean(as.numeric(simAlleleFreq[frqYr==year & frqCat=='pMs-pt',c(3:(nloci+2))])*
as.numeric(simAlleleFreq[frqYr==year & frqCat=='pMi-pt',c(3:(nloci+2))]))
simVar[bsYr==year & bsCat=='xMsxMi',3]<-
mean(as.numeric(simAlleleFreq[frqYr==year & frqCat=='xMs-xt',c(3:(nloci+2))])*
as.numeric(simAlleleFreq[frqYr==year & frqCat=='xMi-xt',c(3:(nloci+2))]))
simVar[bsYr==year & bsCat=='xMserrMI',3]<-
mean(as.numeric(simAlleleFreq[frqYr==year & frqCat=='xMs-xt',c(3:(nloci+2))])*
as.numeric(simAlleleFreq[frqYr==year & frqCat=='errMI-errT',c(3:(nloci+2))]))
simVar[bsYr==year & bsCat=='errMSxMi',3]<-
mean(as.numeric(simAlleleFreq[frqYr==year & frqCat=='errMS-errT',c(3:(nloci+2))])*
as.numeric(simAlleleFreq[frqYr==year & frqCat=='xMi-xt',c(3:(nloci+2))]))
simVar[bsYr==year & bsCat=='errMSerrMI',3]<-
mean(as.numeric(simAlleleFreq[frqYr==year & frqCat=='errMS-errT',c(3:(nloci+2))])*
as.numeric(simAlleleFreq[frqYr==year & frqCat=='errMI-errT',c(3:(nloci+2))]))
simVar[bsYr==year & bsCat=='pMspMb',3]<-
mean(as.numeric(simAlleleFreq[frqYr==year & frqCat=='pMs-pt',c(3:(nloci+2))])*
as.numeric(simAlleleFreq[frqYr==year & frqCat=='pMb-pt',c(3:(nloci+2))]))
simVar[bsYr==year & bsCat=='xMsxMb',3]<-
mean(as.numeric(simAlleleFreq[frqYr==year & frqCat=='xMs-xt',c(3:(nloci+2))])*
as.numeric(simAlleleFreq[frqYr==year & frqCat=='xMb-xt',c(3:(nloci+2))]))
simVar[bsYr==year & bsCat=='xMserrMB',3]<-
mean(as.numeric(simAlleleFreq[frqYr==year & frqCat=='xMs-xt',c(3:(nloci+2))])*
as.numeric(simAlleleFreq[frqYr==year & frqCat=='errMB-errT',c(3:(nloci+2))]))
simVar[bsYr==year & bsCat=='errMSxMb',3]<-
mean(as.numeric(simAlleleFreq[frqYr==year & frqCat=='errMS-errT',c(3:(nloci+2))])*
as.numeric(simAlleleFreq[frqYr==year & frqCat=='xMb-xt',c(3:(nloci+2))]))
simVar[bsYr==year & bsCat=='errMSerrMB',3]<-
mean(as.numeric(simAlleleFreq[frqYr==year & frqCat=='errMS-errT',c(3:(nloci+2))])*
as.numeric(simAlleleFreq[frqYr==year & frqCat=='errMB-errT',c(3:(nloci+2))]))
simVar[bsYr==year & bsCat=='pMipMb',3]<-
mean(as.numeric(simAlleleFreq[frqYr==year & frqCat=='pMi-pt',c(3:(nloci+2))])*
as.numeric(simAlleleFreq[frqYr==year & frqCat=='pMb-pt',c(3:(nloci+2))]))
simVar[bsYr==year & bsCat=='xMixMb',3]<-
mean(as.numeric(simAlleleFreq[frqYr==year & frqCat=='xMi-xt',c(3:(nloci+2))])*
as.numeric(simAlleleFreq[frqYr==year & frqCat=='xMb-xt',c(3:(nloci+2))]))
simVar[bsYr==year & bsCat=='xMierrMB',3]<-
mean(as.numeric(simAlleleFreq[frqYr==year & frqCat=='xMi-xt',c(3:(nloci+2))])*
as.numeric(simAlleleFreq[frqYr==year & frqCat=='errMB-errT',c(3:(nloci+2))]))
simVar[bsYr==year & bsCat=='errMIxMb',3]<-
mean(as.numeric(simAlleleFreq[frqYr==year & frqCat=='errMI-errT',c(3:(nloci+2))])*
as.numeric(simAlleleFreq[frqYr==year & frqCat=='xMb-xt',c(3:(nloci+2))]))
simVar[bsYr==year & bsCat=='errMIerrMB',3]<-
mean(as.numeric(simAlleleFreq[frqYr==year & frqCat=='errMI-errT',c(3:(nloci+2))])*
as.numeric(simAlleleFreq[frqYr==year & frqCat=='errMB-errT',c(3:(nloci+2))]))
#covariance between categories - females
simVar[bsYr==year & bsCat=='pFspFi',3]<-
mean(as.numeric(simAlleleFreq[frqYr==year & frqCat=='pFs-pt',c(3:(nloci+2))])*
as.numeric(simAlleleFreq[frqYr==year & frqCat=='pFi-pt',c(3:(nloci+2))]))
simVar[bsYr==year & bsCat=='xFsxFi',3]<-
mean(as.numeric(simAlleleFreq[frqYr==year & frqCat=='xFs-xt',c(3:(nloci+2))])*
as.numeric(simAlleleFreq[frqYr==year & frqCat=='xFi-xt',c(3:(nloci+2))]))
simVar[bsYr==year & bsCat=='xFserrFI',3]<-
mean(as.numeric(simAlleleFreq[frqYr==year & frqCat=='xFs-xt',c(3:(nloci+2))])*
as.numeric(simAlleleFreq[frqYr==year & frqCat=='errFI-errT',c(3:(nloci+2))]))
simVar[bsYr==year & bsCat=='errFSxFi',3]<-
mean(as.numeric(simAlleleFreq[frqYr==year & frqCat=='errFS-errT',c(3:(nloci+2))])*
as.numeric(simAlleleFreq[frqYr==year & frqCat=='xFi-xt',c(3:(nloci+2))]))
simVar[bsYr==year & bsCat=='errFSerrFI',3]<-
mean(as.numeric(simAlleleFreq[frqYr==year & frqCat=='errFS-errT',c(3:(nloci+2))])*
as.numeric(simAlleleFreq[frqYr==year & frqCat=='errFI-errT',c(3:(nloci+2))]))
simVar[bsYr==year & bsCat=='pFspFb',3]<-
mean(as.numeric(simAlleleFreq[frqYr==year & frqCat=='pFs-pt',c(3:(nloci+2))])*
as.numeric(simAlleleFreq[frqYr==year & frqCat=='pFb-pt',c(3:(nloci+2))]))
simVar[bsYr==year & bsCat=='xFsxFb',3]<-
mean(as.numeric(simAlleleFreq[frqYr==year & frqCat=='xFs-xt',c(3:(nloci+2))])*
as.numeric(simAlleleFreq[frqYr==year & frqCat=='xFb-xt',c(3:(nloci+2))]))
simVar[bsYr==year & bsCat=='xFserrFB',3]<-
mean(as.numeric(simAlleleFreq[frqYr==year & frqCat=='xFs-xt',c(3:(nloci+2))])*
as.numeric(simAlleleFreq[frqYr==year & frqCat=='errFB-errT',c(3:(nloci+2))]))
simVar[bsYr==year & bsCat=='errFSxFb',3]<-
mean(as.numeric(simAlleleFreq[frqYr==year & frqCat=='errFS-errT',c(3:(nloci+2))])*
as.numeric(simAlleleFreq[frqYr==year & frqCat=='xFb-xt',c(3:(nloci+2))]))
simVar[bsYr==year & bsCat=='errFSerrFB',3]<-
mean(as.numeric(simAlleleFreq[frqYr==year & frqCat=='errFS-errT',c(3:(nloci+2))])*
as.numeric(simAlleleFreq[frqYr==year & frqCat=='errFB-errT',c(3:(nloci+2))]))
simVar[bsYr==year & bsCat=='pFipFb',3]<-
mean(as.numeric(simAlleleFreq[frqYr==year & frqCat=='pFi-pt',c(3:(nloci+2))])*
as.numeric(simAlleleFreq[frqYr==year & frqCat=='pFb-pt',c(3:(nloci+2))]))
simVar[bsYr==year & bsCat=='xFixFb',3]<-
mean(as.numeric(simAlleleFreq[frqYr==year & frqCat=='xFi-xt',c(3:(nloci+2))])*
as.numeric(simAlleleFreq[frqYr==year & frqCat=='xFb-xt',c(3:(nloci+2))]))
simVar[bsYr==year & bsCat=='xFierrFB',3]<-
mean(as.numeric(simAlleleFreq[frqYr==year & frqCat=='xFi-xt',c(3:(nloci+2))])*
as.numeric(simAlleleFreq[frqYr==year & frqCat=='errFB-errT',c(3:(nloci+2))]))
simVar[bsYr==year & bsCat=='errFIxFb',3]<-
mean(as.numeric(simAlleleFreq[frqYr==year & frqCat=='errFI-errT',c(3:(nloci+2))])*
as.numeric(simAlleleFreq[frqYr==year & frqCat=='xFb-xt',c(3:(nloci+2))]))
simVar[bsYr==year & bsCat=='errFIerrFB',3]<-
mean(as.numeric(simAlleleFreq[frqYr==year & frqCat=='errFI-errT',c(3:(nloci+2))])*
as.numeric(simAlleleFreq[frqYr==year & frqCat=='errFB-errT',c(3:(nloci+2))]))
#covariance between males and females within a category
#survivors
simVar[bsYr==year & bsCat=='pMspFs',3]<-
mean(as.numeric(simAlleleFreq[frqYr==year & frqCat=='pMs-pt',c(3:(nloci+2))])*
as.numeric(simAlleleFreq[frqYr==year & frqCat=='pFs-pt',c(3:(nloci+2))]))
simVar[bsYr==year & bsCat=='xMsxFs',3]<-
mean(as.numeric(simAlleleFreq[frqYr==year & frqCat=='xMs-xt',c(3:(nloci+2))])*
as.numeric(simAlleleFreq[frqYr==year & frqCat=='xFs-xt',c(3:(nloci+2))]))
simVar[bsYr==year & bsCat=='xMserrFS',3]<-
mean(as.numeric(simAlleleFreq[frqYr==year & frqCat=='xMs-xt',c(3:(nloci+2))])*
as.numeric(simAlleleFreq[frqYr==year & frqCat=='errFS-errT',c(3:(nloci+2))]))
simVar[bsYr==year & bsCat=='errMSxFs',3]<-
mean(as.numeric(simAlleleFreq[frqYr==year & frqCat=='errMS-errT',c(3:(nloci+2))])*
as.numeric(simAlleleFreq[frqYr==year & frqCat=='xFs-xt',c(3:(nloci+2))]))
simVar[bsYr==year & bsCat=='errMSerrFS',3]<-
mean(as.numeric(simAlleleFreq[frqYr==year & frqCat=='errMS-errT',c(3:(nloci+2))])*
as.numeric(simAlleleFreq[frqYr==year & frqCat=='errFS-errT',c(3:(nloci+2))]))
#imms
simVar[bsYr==year & bsCat=='pMipFi',3]<-
mean(as.numeric(simAlleleFreq[frqYr==year & frqCat=='pMi-pt',c(3:(nloci+2))])*
as.numeric(simAlleleFreq[frqYr==year & frqCat=='pFi-pt',c(3:(nloci+2))]))
simVar[bsYr==year & bsCat=='xMixFi',3]<-
mean(as.numeric(simAlleleFreq[frqYr==year & frqCat=='xMi-xt',c(3:(nloci+2))])*
as.numeric(simAlleleFreq[frqYr==year & frqCat=='xFi-xt',c(3:(nloci+2))]))
simVar[bsYr==year & bsCat=='xMierrFI',3]<-
mean(as.numeric(simAlleleFreq[frqYr==year & frqCat=='xMi-xt',c(3:(nloci+2))])*
as.numeric(simAlleleFreq[frqYr==year & frqCat=='errFI-errT',c(3:(nloci+2))]))
simVar[bsYr==year & bsCat=='errMIxFi',3]<-
mean(as.numeric(simAlleleFreq[frqYr==year & frqCat=='errMI-errT',c(3:(nloci+2))])*
as.numeric(simAlleleFreq[frqYr==year & frqCat=='xFi-xt',c(3:(nloci+2))]))
simVar[bsYr==year & bsCat=='errMIerrFI',3]<-
mean(as.numeric(simAlleleFreq[frqYr==year & frqCat=='errMI-errT',c(3:(nloci+2))])*
as.numeric(simAlleleFreq[frqYr==year & frqCat=='errFI-errT',c(3:(nloci+2))]))
#births
simVar[bsYr==year & bsCat=='pMbpFb',3]<-
mean(as.numeric(simAlleleFreq[frqYr==year & frqCat=='pMb-pt',c(3:(nloci+2))])*
as.numeric(simAlleleFreq[frqYr==year & frqCat=='pFb-pt',c(3:(nloci+2))]))
simVar[bsYr==year & bsCat=='xMbxFb',3]<-
mean(as.numeric(simAlleleFreq[frqYr==year & frqCat=='xMb-xt',c(3:(nloci+2))])*
as.numeric(simAlleleFreq[frqYr==year & frqCat=='xFb-xt',c(3:(nloci+2))]))
simVar[bsYr==year & bsCat=='xMberrFB',3]<-
mean(as.numeric(simAlleleFreq[frqYr==year & frqCat=='xMb-xt',c(3:(nloci+2))])*
as.numeric(simAlleleFreq[frqYr==year & frqCat=='errFB-errT',c(3:(nloci+2))]))
simVar[bsYr==year & bsCat=='errMBxFb',3]<-
mean(as.numeric(simAlleleFreq[frqYr==year & frqCat=='errMB-errT',c(3:(nloci+2))])*
as.numeric(simAlleleFreq[frqYr==year & frqCat=='xFb-xt',c(3:(nloci+2))]))
simVar[bsYr==year & bsCat=='errMBerrFB',3]<-
mean(as.numeric(simAlleleFreq[frqYr==year & frqCat=='errMB-errT',c(3:(nloci+2))])*
as.numeric(simAlleleFreq[frqYr==year & frqCat=='errFB-errT',c(3:(nloci+2))]))
#covariance between males and females in different categories
simVar[bsYr==year & bsCat=='pMspFi',3]<-
mean(as.numeric(simAlleleFreq[frqYr==year & frqCat=='pMs-pt',c(3:(nloci+2))])*
as.numeric(simAlleleFreq[frqYr==year & frqCat=='pFi-pt',c(3:(nloci+2))]))
simVar[bsYr==year & bsCat=='xMsxFi',3]<-
mean(as.numeric(simAlleleFreq[frqYr==year & frqCat=='xMs-xt',c(3:(nloci+2))])*
as.numeric(simAlleleFreq[frqYr==year & frqCat=='xFi-xt',c(3:(nloci+2))]))
simVar[bsYr==year & bsCat=='xMserrFI',3]<-
mean(as.numeric(simAlleleFreq[frqYr==year & frqCat=='xMs-xt',c(3:(nloci+2))])*
as.numeric(simAlleleFreq[frqYr==year & frqCat=='errFI-errT',c(3:(nloci+2))]))
simVar[bsYr==year & bsCat=='errMSxFi',3]<-
mean(as.numeric(simAlleleFreq[frqYr==year & frqCat=='errMS-errT',c(3:(nloci+2))])*
as.numeric(simAlleleFreq[frqYr==year & frqCat=='xFi-xt',c(3:(nloci+2))]))
simVar[bsYr==year & bsCat=='errMSerrFI',3]<-
mean(as.numeric(simAlleleFreq[frqYr==year & frqCat=='errMS-errT',c(3:(nloci+2))])*
as.numeric(simAlleleFreq[frqYr==year & frqCat=='errFI-errT',c(3:(nloci+2))]))
simVar[bsYr==year & bsCat=='pMspFb',3]<-
mean(as.numeric(simAlleleFreq[frqYr==year & frqCat=='pMs-pt',c(3:(nloci+2))])*
as.numeric(simAlleleFreq[frqYr==year & frqCat=='pFb-pt',c(3:(nloci+2))]))
simVar[bsYr==year & bsCat=='xMsxFb',3]<-
mean(as.numeric(simAlleleFreq[frqYr==year & frqCat=='xMs-xt',c(3:(nloci+2))])*
as.numeric(simAlleleFreq[frqYr==year & frqCat=='xFb-xt',c(3:(nloci+2))]))
simVar[bsYr==year & bsCat=='xMserrFB',3]<-
mean(as.numeric(simAlleleFreq[frqYr==year & frqCat=='xMs-xt',c(3:(nloci+2))])*
as.numeric(simAlleleFreq[frqYr==year & frqCat=='errFB-errT',c(3:(nloci+2))]))
simVar[bsYr==year & bsCat=='errMSxFb',3]<-
mean(as.numeric(simAlleleFreq[frqYr==year & frqCat=='errMS-errT',c(3:(nloci+2))])*
as.numeric(simAlleleFreq[frqYr==year & frqCat=='xFb-xt',c(3:(nloci+2))]))
simVar[bsYr==year & bsCat=='errMSerrFB',3]<-
mean(as.numeric(simAlleleFreq[frqYr==year & frqCat=='errMS-errT',c(3:(nloci+2))])*
as.numeric(simAlleleFreq[frqYr==year & frqCat=='errFB-errT',c(3:(nloci+2))]))
simVar[bsYr==year & bsCat=='pMipFb',3]<-
mean(as.numeric(simAlleleFreq[frqYr==year & frqCat=='pMi-pt',c(3:(nloci+2))])*
as.numeric(simAlleleFreq[frqYr==year & frqCat=='pFb-pt',c(3:(nloci+2))]))
simVar[bsYr==year & bsCat=='xMixFb',3]<-
mean(as.numeric(simAlleleFreq[frqYr==year & frqCat=='xMi-xt',c(3:(nloci+2))])*
as.numeric(simAlleleFreq[frqYr==year & frqCat=='xFb-xt',c(3:(nloci+2))]))
simVar[bsYr==year & bsCat=='xMierrFB',3]<-
mean(as.numeric(simAlleleFreq[frqYr==year & frqCat=='xMi-xt',c(3:(nloci+2))])*
as.numeric(simAlleleFreq[frqYr==year & frqCat=='errFB-errT',c(3:(nloci+2))]))
simVar[bsYr==year & bsCat=='errMIxFb',3]<-
mean(as.numeric(simAlleleFreq[frqYr==year & frqCat=='errMI-errT',c(3:(nloci+2))])*
as.numeric(simAlleleFreq[frqYr==year & frqCat=='xFb-xt',c(3:(nloci+2))]))
simVar[bsYr==year & bsCat=='errMIerrFB',3]<-
mean(as.numeric(simAlleleFreq[frqYr==year & frqCat=='errMI-errT',c(3:(nloci+2))])*
as.numeric(simAlleleFreq[frqYr==year & frqCat=='errFB-errT',c(3:(nloci+2))]))
simVar[bsYr==year & bsCat=='pFspMi',3]<-
mean(as.numeric(simAlleleFreq[frqYr==year & frqCat=='pFs-pt',c(3:(nloci+2))])*
as.numeric(simAlleleFreq[frqYr==year & frqCat=='pMi-pt',c(3:(nloci+2))]))
simVar[bsYr==year & bsCat=='xFsxMi',3]<-
mean(as.numeric(simAlleleFreq[frqYr==year & frqCat=='xFs-xt',c(3:(nloci+2))])*
as.numeric(simAlleleFreq[frqYr==year & frqCat=='xMi-xt',c(3:(nloci+2))]))
simVar[bsYr==year & bsCat=='xFserrMI',3]<-
mean(as.numeric(simAlleleFreq[frqYr==year & frqCat=='xFs-xt',c(3:(nloci+2))])*
as.numeric(simAlleleFreq[frqYr==year & frqCat=='errMI-errT',c(3:(nloci+2))]))
simVar[bsYr==year & bsCat=='errFSxMi',3]<-
mean(as.numeric(simAlleleFreq[frqYr==year & frqCat=='errFS-errT',c(3:(nloci+2))])*
as.numeric(simAlleleFreq[frqYr==year & frqCat=='xMi-xt',c(3:(nloci+2))]))
simVar[bsYr==year & bsCat=='errFSerrMI',3]<-
mean(as.numeric(simAlleleFreq[frqYr==year & frqCat=='errFS-errT',c(3:(nloci+2))])*
as.numeric(simAlleleFreq[frqYr==year & frqCat=='errMI-errT',c(3:(nloci+2))]))
simVar[bsYr==year & bsCat=='pFspMb',3]<-
mean(as.numeric(simAlleleFreq[frqYr==year & frqCat=='pFs-pt',c(3:(nloci+2))])*
as.numeric(simAlleleFreq[frqYr==year & frqCat=='pMb-pt',c(3:(nloci+2))]))
simVar[bsYr==year & bsCat=='xFsxMb',3]<-
mean(as.numeric(simAlleleFreq[frqYr==year & frqCat=='xFs-xt',c(3:(nloci+2))])*
as.numeric(simAlleleFreq[frqYr==year & frqCat=='xMb-xt',c(3:(nloci+2))]))
simVar[bsYr==year & bsCat=='xFserrMB',3]<-
mean(as.numeric(simAlleleFreq[frqYr==year & frqCat=='xFs-xt',c(3:(nloci+2))])*
as.numeric(simAlleleFreq[frqYr==year & frqCat=='errMB-errT',c(3:(nloci+2))]))
simVar[bsYr==year & bsCat=='errFSxMb',3]<-
mean(as.numeric(simAlleleFreq[frqYr==year & frqCat=='errFS-errT',c(3:(nloci+2))])*
as.numeric(simAlleleFreq[frqYr==year & frqCat=='xMb-xt',c(3:(nloci+2))]))
simVar[bsYr==year & bsCat=='errFSerrMB',3]<-
mean(as.numeric(simAlleleFreq[frqYr==year & frqCat=='errFS-errT',c(3:(nloci+2))])*
as.numeric(simAlleleFreq[frqYr==year & frqCat=='errMB-errT',c(3:(nloci+2))]))
simVar[bsYr==year & bsCat=='pFipMb',3]<-
mean(as.numeric(simAlleleFreq[frqYr==year & frqCat=='pFi-pt',c(3:(nloci+2))])*
as.numeric(simAlleleFreq[frqYr==year & frqCat=='pMb-pt',c(3:(nloci+2))]))
simVar[bsYr==year & bsCat=='xFixMb',3]<-
mean(as.numeric(simAlleleFreq[frqYr==year & frqCat=='xFi-xt',c(3:(nloci+2))])*
as.numeric(simAlleleFreq[frqYr==year & frqCat=='xMb-xt',c(3:(nloci+2))]))
simVar[bsYr==year & bsCat=='xFierrMB',3]<-
mean(as.numeric(simAlleleFreq[frqYr==year & frqCat=='xFi-xt',c(3:(nloci+2))])*
as.numeric(simAlleleFreq[frqYr==year & frqCat=='errMB-errT',c(3:(nloci+2))]))
simVar[bsYr==year & bsCat=='errFIxMb',3]<-
mean(as.numeric(simAlleleFreq[frqYr==year & frqCat=='errFI-errT',c(3:(nloci+2))])*
as.numeric(simAlleleFreq[frqYr==year & frqCat=='xMb-xt',c(3:(nloci+2))]))
simVar[bsYr==year & bsCat=='errFIerrMB',3]<-
mean(as.numeric(simAlleleFreq[frqYr==year & frqCat=='errFI-errT',c(3:(nloci+2))])*
as.numeric(simAlleleFreq[frqYr==year & frqCat=='errMB-errT',c(3:(nloci+2))]))
#variance for mendelian segregation and family size
#males
simVar[bsYr==year & bsCat=='pMmend',3]<-
mean(as.numeric(simAlleleFreq[frqYr==year & frqCat=='pMmend',c(3:(nloci+2))])^2)
simVar[bsYr==year & bsCat=='xMmend',3]<-
mean(as.numeric(simAlleleFreq[frqYr==year & frqCat=='xMmend',c(3:(nloci+2))])^2)
simVar[bsYr==year & bsCat=='errMMEND',3]<-
mean(as.numeric(simAlleleFreq[frqYr==year & frqCat=='errMMEND',c(3:(nloci+2))])^2)
simVar[bsYr==year & bsCat=='pMfam-pt',3]<-
mean(as.numeric(simAlleleFreq[frqYr==year & frqCat=='pMfam-pt',c(3:(nloci+2))])^2)
simVar[bsYr==year & bsCat=='xMfam-xt',3]<-
mean(as.numeric(simAlleleFreq[frqYr==year & frqCat=='xMfam-xt',c(3:(nloci+2))])^2)
simVar[bsYr==year & bsCat=='errMFAM-errT',3]<-
mean(as.numeric(simAlleleFreq[frqYr==year & frqCat=='errMFAM-errT',c(3:(nloci+2))])^2)
#females
simVar[bsYr==year & bsCat=='pFmend',3]<-
mean(as.numeric(simAlleleFreq[frqYr==year & frqCat=='pFmend',c(3:(nloci+2))])^2)
simVar[bsYr==year & bsCat=='xFmend',3]<-
mean(as.numeric(simAlleleFreq[frqYr==year & frqCat=='xFmend',c(3:(nloci+2))])^2)
simVar[bsYr==year & bsCat=='errFMEND',3]<-
mean(as.numeric(simAlleleFreq[frqYr==year & frqCat=='errFMEND',c(3:(nloci+2))])^2)
#as.numeric(simAlleleFreq[frqYr==year & frqCat=='errFMEND',c(3:(10+2))])^2
simVar[bsYr==year & bsCat=='pFfam-pt',3]<-
mean(as.numeric(simAlleleFreq[frqYr==year & frqCat=='pFfam-pt',c(3:(nloci+2))])^2)
simVar[bsYr==year & bsCat=='xFfam-xt',3]<-
mean(as.numeric(simAlleleFreq[frqYr==year & frqCat=='xFfam-xt',c(3:(nloci+2))])^2)
simVar[bsYr==year & bsCat=='errFFAM-errT',3]<-
mean(as.numeric(simAlleleFreq[frqYr==year & frqCat=='errFFAM-errT',c(3:(nloci+2))])^2)
}
#save output
save(simVar,file=paste("working_files/intermediate_files/simVarA.rdata",sep=''))
