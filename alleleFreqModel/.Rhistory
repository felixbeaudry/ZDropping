simAlleleFreq[frqYr==year & frqCat=='errT',c(3:(nloci+2))]<-
simAlleleFreq[frqYr==year & frqCat=='sxt',c(3:(nloci+2))]-
simAlleleFreq[frqYr==year & frqCat=='pt',c(3:(nloci+2))]
simAlleleFreq[frqYr==year & frqCat=='errMS',c(3:(nloci+2))]<-
simAlleleFreq[frqYr==year & frqCat=='sxMs',c(3:(nloci+2))]-
simAlleleFreq[frqYr==year & frqCat=='pMs',c(3:(nloci+2))]
simAlleleFreq[frqYr==year & frqCat=='errFS',c(3:(nloci+2))]<-
simAlleleFreq[frqYr==year & frqCat=='sxFs',c(3:(nloci+2))]-
simAlleleFreq[frqYr==year & frqCat=='pFs',c(3:(nloci+2))]
simAlleleFreq[frqYr==year & frqCat=='errMI',c(3:(nloci+2))]<-
simAlleleFreq[frqYr==year & frqCat=='sxMi',c(3:(nloci+2))]-
simAlleleFreq[frqYr==year & frqCat=='pMi',c(3:(nloci+2))]
simAlleleFreq[frqYr==year & frqCat=='errFI',c(3:(nloci+2))]<-
simAlleleFreq[frqYr==year & frqCat=='sxFi',c(3:(nloci+2))]-
simAlleleFreq[frqYr==year & frqCat=='pFi',c(3:(nloci+2))]
simAlleleFreq[frqYr==year & frqCat=='errMB',c(3:(nloci+2))]<-
simAlleleFreq[frqYr==year & frqCat=='sxMb',c(3:(nloci+2))]-
simAlleleFreq[frqYr==year & frqCat=='pMb',c(3:(nloci+2))]
simAlleleFreq[frqYr==year & frqCat=='errFB',c(3:(nloci+2))]<-
simAlleleFreq[frqYr==year & frqCat=='sxFb',c(3:(nloci+2))]-
simAlleleFreq[frqYr==year & frqCat=='pFb',c(3:(nloci+2))]
#mom
simAlleleFreq[frqYr==year & frqCat=='errMmom',c(3:(nloci+2))]<-
simAlleleFreq[frqYr==year & frqCat=='sxMmom',c(3:(nloci+2))]-
simAlleleFreq[frqYr==year & frqCat=='pMmom',c(3:(nloci+2))]
#dad
simAlleleFreq[frqYr==year & frqCat=='errMdad',c(3:(nloci+2))]<-
simAlleleFreq[frqYr==year & frqCat=='sxMdad',c(3:(nloci+2))]-
simAlleleFreq[frqYr==year & frqCat=='pMdad',c(3:(nloci+2))]
simAlleleFreq[frqYr==year & frqCat=='errFdad',c(3:(nloci+2))]<-
simAlleleFreq[frqYr==year & frqCat=='sxFdad',c(3:(nloci+2))]-
simAlleleFreq[frqYr==year & frqCat=='pFdad',c(3:(nloci+2))]
#allele freq differences
#true (population) freq (p)
#this is actually doing pt - pt-1 even thought the Category name is pt1-pt
#so the math does match my equations
simAlleleFreq[frqYr==year & frqCat=='pt1-pt',c(3:(nloci+2))]<-
simAlleleFreq[frqYr==year & frqCat=='pt',c(3:(nloci+2))]-
simAlleleFreq[frqYr==(year-1) & frqCat=='pt',c(3:(nloci+2))]
simAlleleFreq[frqYr==year & frqCat=='pMs-pt',c(3:(nloci+2))]<-
simAlleleFreq[frqYr==year & frqCat=='pMs',c(3:(nloci+2))]-
simAlleleFreq[frqYr==(year-1) & frqCat=='pt',c(3:(nloci+2))]
simAlleleFreq[frqYr==year & frqCat=='pFs-pt',c(3:(nloci+2))]<-
simAlleleFreq[frqYr==year & frqCat=='pFs',c(3:(nloci+2))]-
simAlleleFreq[frqYr==(year-1) & frqCat=='pt',c(3:(nloci+2))]
simAlleleFreq[frqYr==year & frqCat=='pMi-pt',c(3:(nloci+2))]<-
simAlleleFreq[frqYr==year & frqCat=='pMi',c(3:(nloci+2))]-
simAlleleFreq[frqYr==(year-1) & frqCat=='pt',c(3:(nloci+2))]
simAlleleFreq[frqYr==year & frqCat=='pFi-pt',c(3:(nloci+2))]<-
simAlleleFreq[frqYr==year & frqCat=='pFi',c(3:(nloci+2))]-
simAlleleFreq[frqYr==(year-1) & frqCat=='pt',c(3:(nloci+2))]
simAlleleFreq[frqYr==year & frqCat=='pMb-pt',c(3:(nloci+2))]<-
simAlleleFreq[frqYr==year & frqCat=='pMb',c(3:(nloci+2))]-
simAlleleFreq[frqYr==(year-1) & frqCat=='pt',c(3:(nloci+2))]
simAlleleFreq[frqYr==year & frqCat=='pFb-pt',c(3:(nloci+2))]<-
simAlleleFreq[frqYr==year & frqCat=='pFb',c(3:(nloci+2))]-
simAlleleFreq[frqYr==(year-1) & frqCat=='pt',c(3:(nloci+2))]
#sample freq (x)
simAlleleFreq[frqYr==year & frqCat=='sxMs-xt',c(3:(nloci+2))]<-
simAlleleFreq[frqYr==year & frqCat=='sxMs',c(3:(nloci+2))]-
simAlleleFreq[frqYr==(year-1) & frqCat=='sxt',c(3:(nloci+2))]
simAlleleFreq[frqYr==year & frqCat=='sxFs-xt',c(3:(nloci+2))]<-
simAlleleFreq[frqYr==year & frqCat=='sxFs',c(3:(nloci+2))]-
simAlleleFreq[frqYr==(year-1) & frqCat=='sxt',c(3:(nloci+2))]
simAlleleFreq[frqYr==year & frqCat=='sxMi-xt',c(3:(nloci+2))]<-
simAlleleFreq[frqYr==year & frqCat=='sxMi',c(3:(nloci+2))]-
simAlleleFreq[frqYr==(year-1) & frqCat=='sxt',c(3:(nloci+2))]
simAlleleFreq[frqYr==year & frqCat=='sxFi-xt',c(3:(nloci+2))]<-
simAlleleFreq[frqYr==year & frqCat=='sxFi',c(3:(nloci+2))]-
simAlleleFreq[frqYr==(year-1) & frqCat=='sxt',c(3:(nloci+2))]
simAlleleFreq[frqYr==year & frqCat=='sxMb-xt',c(3:(nloci+2))]<-
simAlleleFreq[frqYr==year & frqCat=='sxMb',c(3:(nloci+2))]-
simAlleleFreq[frqYr==(year-1) & frqCat=='sxt',c(3:(nloci+2))]
simAlleleFreq[frqYr==year & frqCat=='sxFb-xt',c(3:(nloci+2))]<-
simAlleleFreq[frqYr==year & frqCat=='sxFb',c(3:(nloci+2))]-
simAlleleFreq[frqYr==(year-1) & frqCat=='sxt',c(3:(nloci+2))]
#true errors
simAlleleFreq[frqYr==year & frqCat=='errMS-errT',c(3:(nloci+2))]<-
simAlleleFreq[frqYr==year & frqCat=='errMS',c(3:(nloci+2))]-
simAlleleFreq[frqYr==(year-1) & frqCat=='errT',c(3:(nloci+2))]
simAlleleFreq[frqYr==year & frqCat=='errFS-errT',c(3:(nloci+2))]<-
simAlleleFreq[frqYr==year & frqCat=='errFS',c(3:(nloci+2))]-
simAlleleFreq[frqYr==(year-1) & frqCat=='errT',c(3:(nloci+2))]
simAlleleFreq[frqYr==year & frqCat=='errMI-errT',c(3:(nloci+2))]<-
simAlleleFreq[frqYr==year & frqCat=='errMI',c(3:(nloci+2))]-
simAlleleFreq[frqYr==(year-1) & frqCat=='errT',c(3:(nloci+2))]
simAlleleFreq[frqYr==year & frqCat=='errFI-errT',c(3:(nloci+2))]<-
simAlleleFreq[frqYr==year & frqCat=='errFI',c(3:(nloci+2))]-
simAlleleFreq[frqYr==(year-1) & frqCat=='errT',c(3:(nloci+2))]
simAlleleFreq[frqYr==year & frqCat=='errMB-errT',c(3:(nloci+2))]<-
simAlleleFreq[frqYr==year & frqCat=='errMB',c(3:(nloci+2))]-
simAlleleFreq[frqYr==(year-1) & frqCat=='errT',c(3:(nloci+2))]
simAlleleFreq[frqYr==year & frqCat=='errFB-errT',c(3:(nloci+2))]<-
simAlleleFreq[frqYr==year & frqCat=='errFB',c(3:(nloci+2))]-
simAlleleFreq[frqYr==(year-1) & frqCat=='errT',c(3:(nloci+2))]
#Mendelian noise
simAlleleFreq[frqYr==year & frqCat=='pMfam',c(3:(nloci+2))]<-
0.5*(simAlleleFreq[frqYr==year & frqCat=='pMmom',c(3:(nloci+2))]+
simAlleleFreq[frqYr==year & frqCat=='pMdad',c(3:(nloci+2))])
#here we also multiply mom by 0.5 since her contribution makes up only 1/2 of her son's genotype
simAlleleFreq[frqYr==year & frqCat=='pFfam',c(3:(nloci+2))]<-
simAlleleFreq[frqYr==year & frqCat=='pFdad',c(3:(nloci+2))]
#here we don't multiply dad by 0.5 since his contribution makes up 100% of his daughter's genotype
simAlleleFreq[frqYr==year & frqCat=='pMmend',c(3:(nloci+2))]<-
simAlleleFreq[frqYr==year & frqCat=='pMb',c(3:(nloci+2))]-
simAlleleFreq[frqYr==year & frqCat=='pMfam',c(3:(nloci+2))]
simAlleleFreq[frqYr==year & frqCat=='pFmend',c(3:(nloci+2))]<-
simAlleleFreq[frqYr==year & frqCat=='pFb',c(3:(nloci+2))]-
simAlleleFreq[frqYr==year & frqCat=='pFfam',c(3:(nloci+2))]
simAlleleFreq[frqYr==year & frqCat=='pMfam-pt',c(3:(nloci+2))]<-
simAlleleFreq[frqYr==year & frqCat=='pMfam',c(3:(nloci+2))]-
simAlleleFreq[frqYr==(year-1) & frqCat=='pt',c(3:(nloci+2))]
simAlleleFreq[frqYr==year & frqCat=='pFfam-pt',c(3:(nloci+2))]<-
simAlleleFreq[frqYr==year & frqCat=='pFfam',c(3:(nloci+2))]-
simAlleleFreq[frqYr==(year-1) & frqCat=='pt',c(3:(nloci+2))]
simAlleleFreq[frqYr==year & frqCat=='sxMfam',c(3:(nloci+2))]<-
0.5*(simAlleleFreq[frqYr==year & frqCat=='sxMmom',c(3:(nloci+2))]+
simAlleleFreq[frqYr==year & frqCat=='sxMdad',c(3:(nloci+2))])
#here we also multiply mom by 0.5 since her contribution makes up only 1/2 of her son's genotype
simAlleleFreq[frqYr==year & frqCat=='sxFfam',c(3:(nloci+2))]<-
simAlleleFreq[frqYr==year & frqCat=='sxFdad',c(3:(nloci+2))]
#here we don't multiply dad by 0.5 since his contribution makes up 100% of his daughter's genotype
simAlleleFreq[frqYr==year & frqCat=='sxMmend',c(3:(nloci+2))]<-
simAlleleFreq[frqYr==year & frqCat=='sxMb',c(3:(nloci+2))]-
simAlleleFreq[frqYr==year & frqCat=='sxMfam',c(3:(nloci+2))]
simAlleleFreq[frqYr==year & frqCat=='sxFmend',c(3:(nloci+2))]<-
simAlleleFreq[frqYr==year & frqCat=='sxFb',c(3:(nloci+2))]-
simAlleleFreq[frqYr==year & frqCat=='sxFfam',c(3:(nloci+2))]
simAlleleFreq[frqYr==year & frqCat=='sxMfam-xt',c(3:(nloci+2))]<-
simAlleleFreq[frqYr==year & frqCat=='sxMfam',c(3:(nloci+2))]-
simAlleleFreq[frqYr==(year-1) & frqCat=='sxt',c(3:(nloci+2))]
simAlleleFreq[frqYr==year & frqCat=='sxFfam-xt',c(3:(nloci+2))]<-
simAlleleFreq[frqYr==year & frqCat=='sxFfam',c(3:(nloci+2))]-
simAlleleFreq[frqYr==(year-1) & frqCat=='sxt',c(3:(nloci+2))]
simAlleleFreq[frqYr==year & frqCat=='errMFAM',c(3:(nloci+2))]<-
0.5*(simAlleleFreq[frqYr==year & frqCat=='errMmom',c(3:(nloci+2))]+
simAlleleFreq[frqYr==year & frqCat=='errMdad',c(3:(nloci+2))])
#here we also multiply mom by 0.5 since her contribution makes up only 1/2 of her son's genotype
simAlleleFreq[frqYr==year & frqCat=='errFFAM',c(3:(nloci+2))]<-
simAlleleFreq[frqYr==year & frqCat=='errFdad',c(3:(nloci+2))]
#here we don't multiply dad by 0.5 since his contribution makes up 100% of his daughter's genotype
simAlleleFreq[frqYr==year & frqCat=='errMMEND',c(3:(nloci+2))]<-
simAlleleFreq[frqYr==year & frqCat=='errMB',c(3:(nloci+2))]-
simAlleleFreq[frqYr==year & frqCat=='errMFAM',c(3:(nloci+2))]
simAlleleFreq[frqYr==year & frqCat=='errFMEND',c(3:(nloci+2))]<-
simAlleleFreq[frqYr==year & frqCat=='errFB',c(3:(nloci+2))]-
simAlleleFreq[frqYr==year & frqCat=='errFFAM',c(3:(nloci+2))]
simAlleleFreq[frqYr==year & frqCat=='errMFAM-errT',c(3:(nloci+2))]<-
simAlleleFreq[frqYr==year & frqCat=='errMFAM',c(3:(nloci+2))]-
simAlleleFreq[frqYr==(year-1) & frqCat=='errT',c(3:(nloci+2))]
simAlleleFreq[frqYr==year & frqCat=='errFFAM-errT',c(3:(nloci+2))]<-
simAlleleFreq[frqYr==year & frqCat=='errFFAM',c(3:(nloci+2))]-
simAlleleFreq[frqYr==(year-1) & frqCat=='errT',c(3:(nloci+2))]
}
simAlleleFreq
#calculate variances and covariances
simVar<-data.frame(Year=rep(c(1999:2013),each=112),Category=rep(c(
'pt1-pt',
'pMs-pt','sxMs-xt','errMS-errT','pMspterrMSerrT',
'pFs-pt','sxFs-xt','errFS-errT','pFspterrFSerrT',
'pMi-pt','sxMi-xt','errMI-errT','pMipterrMIerrT',
'pFi-pt','sxFi-xt','errFI-errT','pFipterrFIerrT',
'pMb-pt','sxMb-xt','errMB-errT','pMbpterrMBerrT',
'pFb-pt','sxFb-xt','errFB-errT','pFbpterrFBerrT',
'pMspMi','sxMsxMi','sxMserrMI','errMSxMi','errMSerrMI',
'pMspMb','sxMsxMb','sxMserrMB','errMSxMb','errMSerrMB',
'pMipMb','sxMixMb','sxMierrMB','errMIxMb','errMIerrMB',
'pFspFi','sxFsxFi','sxFserrFI','errFSxFi','errFSerrFI',
'pFspFb','sxFsxFb','sxFserrFB','errFSxFb','errFSerrFB',
'pFipFb','sxFixFb','sxFierrFB','errFIxFb','errFIerrFB',
'pMspFs','sxMsxFs','sxMserrFS','errMSxFs','errMSerrFS',
'pMipFi','sxMixFi','sxMierrFI','errMIxFi','errMIerrFI',
'pMbpFb','sxMbxFb','sxMberrFB','errMBxFb','errMBerrFB',
'pMspFi','sxMsxFi','sxMserrFI','errMSxFi','errMSerrFI',
'pMspFb','sxMsxFb','sxMserrFB','errMSxFb','errMSerrFB',
'pMipFb','sxMixFb','sxMierrFB','errMIxFb','errMIerrFB',
'pFspMi','sxFsxMi','sxFserrMI','errFSxMi','errFSerrMI',
'pFspMb','sxFsxMb','sxFserrMB','errFSxMb','errFSerrMB',
'pFipMb','sxFixMb','sxFierrMB','errFIxMb','errFIerrMB',
'pMmend','sxMmend','errMMEND','pMfam-pt','sxMfam-xt','errMFAM-errT',
'pFmend','sxFmend','errFMEND','pFfam-pt','sxFfam-xt','errFFAM-errT')
,15),stringsAsFactors=FALSE)
bsYr<-simVar$Year
bsCat<-simVar$Category
for(year in c(1999:2013)){
#total variance, for males and females
simVar[bsYr==year & bsCat=='pt1-pt',3]<-
mean(as.numeric(simAlleleFreq[frqYr==year & frqCat=='pt1-pt',c(3:(nloci+2))])^2)
#variance for each Category, for males and females
#survivors
simVar[bsYr==year & bsCat=='pMs-pt',3]<-
mean(as.numeric(simAlleleFreq[frqYr==year & frqCat=='pMs-pt',c(3:(nloci+2))])^2)
simVar[bsYr==year & bsCat=='sxMs-xt',3]<-
mean(as.numeric(simAlleleFreq[frqYr==year & frqCat=='sxMs-xt',c(3:(nloci+2))])^2)
simVar[bsYr==year & bsCat=='errMS-errT',3]<-
mean(as.numeric(simAlleleFreq[frqYr==year & frqCat=='errMS-errT',c(3:(nloci+2))])^2)
simVar[bsYr==year & bsCat=='pMspterrMSerrT',3]<-
mean(as.numeric(simAlleleFreq[frqYr==year & frqCat=='pMs-pt',c(3:(nloci+2))])*
as.numeric(simAlleleFreq[frqYr==year & frqCat=='errMS-errT',c(3:(nloci+2))]))
simVar[bsYr==year & bsCat=='pFs-pt',3]<-
mean(as.numeric(simAlleleFreq[frqYr==year & frqCat=='pFs-pt',c(3:(nloci+2))])^2)
simVar[bsYr==year & bsCat=='sxFs-xt',3]<-
mean(as.numeric(simAlleleFreq[frqYr==year & frqCat=='sxFs-xt',c(3:(nloci+2))])^2)
simVar[bsYr==year & bsCat=='errFS-errT',3]<-
mean(as.numeric(simAlleleFreq[frqYr==year & frqCat=='errFS-errT',c(3:(nloci+2))])^2)
simVar[bsYr==year & bsCat=='pFspterrFSerrT',3]<-
mean(as.numeric(simAlleleFreq[frqYr==year & frqCat=='pFs-pt',c(3:(nloci+2))])*
as.numeric(simAlleleFreq[frqYr==year & frqCat=='errFS-errT',c(3:(nloci+2))]))
#imms
simVar[bsYr==year & bsCat=='pMi-pt',3]<-
mean(as.numeric(simAlleleFreq[frqYr==year & frqCat=='pMi-pt',c(3:(nloci+2))])^2)
simVar[bsYr==year & bsCat=='sxMi-xt',3]<-
mean(as.numeric(simAlleleFreq[frqYr==year & frqCat=='sxMi-xt',c(3:(nloci+2))])^2)
simVar[bsYr==year & bsCat=='errMI-errT',3]<-
mean(as.numeric(simAlleleFreq[frqYr==year & frqCat=='errMI-errT',c(3:(nloci+2))])^2)
simVar[bsYr==year & bsCat=='pMipterrMIerrT',3]<-
mean(as.numeric(simAlleleFreq[frqYr==year & frqCat=='pMi-pt',c(3:(nloci+2))])*
as.numeric(simAlleleFreq[frqYr==year & frqCat=='errMI-errT',c(3:(nloci+2))]))
simVar[bsYr==year & bsCat=='pFi-pt',3]<-
mean(as.numeric(simAlleleFreq[frqYr==year & frqCat=='pFi-pt',c(3:(nloci+2))])^2)
simVar[bsYr==year & bsCat=='sxFi-xt',3]<-
mean(as.numeric(simAlleleFreq[frqYr==year & frqCat=='sxFi-xt',3:(nloci+2)])^2)
simVar[bsYr==year & bsCat=='errFI-errT',3]<-
mean(as.numeric(simAlleleFreq[frqYr==year & frqCat=='errFI-errT',c(3:(nloci+2))])^2)
simVar[bsYr==year & bsCat=='pFipterrFIerrT',3]<-
mean(as.numeric(simAlleleFreq[frqYr==year & frqCat=='pFi-pt',c(3:(nloci+2))])*
as.numeric(simAlleleFreq[frqYr==year & frqCat=='errFI-errT',c(3:(nloci+2))]))
#births
simVar[bsYr==year & bsCat=='pMb-pt',3]<-
mean(as.numeric(simAlleleFreq[frqYr==year & frqCat=='pMb-pt',c(3:(nloci+2))])^2)
simVar[bsYr==year & bsCat=='sxMb-xt',3]<-
mean(as.numeric(simAlleleFreq[frqYr==year & frqCat=='sxMb-xt',c(3:(nloci+2))])^2)
simVar[bsYr==year & bsCat=='errMB-errT',3]<-
mean(as.numeric(simAlleleFreq[frqYr==year & frqCat=='errMB-errT',c(3:(nloci+2))])^2)
simVar[bsYr==year & bsCat=='pMbpterrMBerrT',3]<-
mean(as.numeric(simAlleleFreq[frqYr==year & frqCat=='pMb-pt',c(3:(nloci+2))])*
as.numeric(simAlleleFreq[frqYr==year & frqCat=='errMB-errT',c(3:(nloci+2))]))
simVar[bsYr==year & bsCat=='pFb-pt',3]<-
mean(as.numeric(simAlleleFreq[frqYr==year & frqCat=='pFb-pt',c(3:(nloci+2))])^2)
simVar[bsYr==year & bsCat=='sxFb-xt',3]<-
mean(as.numeric(simAlleleFreq[frqYr==year & frqCat=='sxFb-xt',c(3:(nloci+2))])^2)
simVar[bsYr==year & bsCat=='errFB-errT',3]<-
mean(as.numeric(simAlleleFreq[frqYr==year & frqCat=='errFB-errT',c(3:(nloci+2))])^2)
simVar[bsYr==year & bsCat=='pFbpterrFBerrT',3]<-
mean(as.numeric(simAlleleFreq[frqYr==year & frqCat=='pFb-pt',c(3:(nloci+2))])*
as.numeric(simAlleleFreq[frqYr==year & frqCat=='errFB-errT',c(3:(nloci+2))]))
#covariance between categories - males
simVar[bsYr==year & bsCat=='pMspMi',3]<-
mean(as.numeric(simAlleleFreq[frqYr==year & frqCat=='pMs-pt',c(3:(nloci+2))])*
as.numeric(simAlleleFreq[frqYr==year & frqCat=='pMi-pt',c(3:(nloci+2))]))
simVar[bsYr==year & bsCat=='sxMsxMi',3]<-
mean(as.numeric(simAlleleFreq[frqYr==year & frqCat=='sxMs-xt',c(3:(nloci+2))])*
as.numeric(simAlleleFreq[frqYr==year & frqCat=='sxMi-xt',c(3:(nloci+2))]))
simVar[bsYr==year & bsCat=='sxMserrMI',3]<-
mean(as.numeric(simAlleleFreq[frqYr==year & frqCat=='sxMs-xt',c(3:(nloci+2))])*
as.numeric(simAlleleFreq[frqYr==year & frqCat=='errMI-errT',c(3:(nloci+2))]))
simVar[bsYr==year & bsCat=='errMSxMi',3]<-
mean(as.numeric(simAlleleFreq[frqYr==year & frqCat=='errMS-errT',c(3:(nloci+2))])*
as.numeric(simAlleleFreq[frqYr==year & frqCat=='sxMi-xt',c(3:(nloci+2))]))
simVar[bsYr==year & bsCat=='errMSerrMI',3]<-
mean(as.numeric(simAlleleFreq[frqYr==year & frqCat=='errMS-errT',c(3:(nloci+2))])*
as.numeric(simAlleleFreq[frqYr==year & frqCat=='errMI-errT',c(3:(nloci+2))]))
simVar[bsYr==year & bsCat=='pMspMb',3]<-
mean(as.numeric(simAlleleFreq[frqYr==year & frqCat=='pMs-pt',c(3:(nloci+2))])*
as.numeric(simAlleleFreq[frqYr==year & frqCat=='pMb-pt',c(3:(nloci+2))]))
simVar[bsYr==year & bsCat=='sxMsxMb',3]<-
mean(as.numeric(simAlleleFreq[frqYr==year & frqCat=='sxMs-xt',c(3:(nloci+2))])*
as.numeric(simAlleleFreq[frqYr==year & frqCat=='sxMb-xt',c(3:(nloci+2))]))
simVar[bsYr==year & bsCat=='sxMserrMB',3]<-
mean(as.numeric(simAlleleFreq[frqYr==year & frqCat=='sxMs-xt',c(3:(nloci+2))])*
as.numeric(simAlleleFreq[frqYr==year & frqCat=='errMB-errT',c(3:(nloci+2))]))
simVar[bsYr==year & bsCat=='errMSxMb',3]<-
mean(as.numeric(simAlleleFreq[frqYr==year & frqCat=='errMS-errT',c(3:(nloci+2))])*
as.numeric(simAlleleFreq[frqYr==year & frqCat=='sxMb-xt',c(3:(nloci+2))]))
simVar[bsYr==year & bsCat=='errMSerrMB',3]<-
mean(as.numeric(simAlleleFreq[frqYr==year & frqCat=='errMS-errT',c(3:(nloci+2))])*
as.numeric(simAlleleFreq[frqYr==year & frqCat=='errMB-errT',c(3:(nloci+2))]))
simVar[bsYr==year & bsCat=='pMipMb',3]<-
mean(as.numeric(simAlleleFreq[frqYr==year & frqCat=='pMi-pt',c(3:(nloci+2))])*
as.numeric(simAlleleFreq[frqYr==year & frqCat=='pMb-pt',c(3:(nloci+2))]))
simVar[bsYr==year & bsCat=='sxMixMb',3]<-
mean(as.numeric(simAlleleFreq[frqYr==year & frqCat=='sxMi-xt',c(3:(nloci+2))])*
as.numeric(simAlleleFreq[frqYr==year & frqCat=='sxMb-xt',c(3:(nloci+2))]))
simVar[bsYr==year & bsCat=='sxMierrMB',3]<-
mean(as.numeric(simAlleleFreq[frqYr==year & frqCat=='sxMi-xt',c(3:(nloci+2))])*
as.numeric(simAlleleFreq[frqYr==year & frqCat=='errMB-errT',c(3:(nloci+2))]))
simVar[bsYr==year & bsCat=='errMIxMb',3]<-
mean(as.numeric(simAlleleFreq[frqYr==year & frqCat=='errMI-errT',c(3:(nloci+2))])*
as.numeric(simAlleleFreq[frqYr==year & frqCat=='sxMb-xt',c(3:(nloci+2))]))
simVar[bsYr==year & bsCat=='errMIerrMB',3]<-
mean(as.numeric(simAlleleFreq[frqYr==year & frqCat=='errMI-errT',c(3:(nloci+2))])*
as.numeric(simAlleleFreq[frqYr==year & frqCat=='errMB-errT',c(3:(nloci+2))]))
#covariance between categories - females
simVar[bsYr==year & bsCat=='pFspFi',3]<-
mean(as.numeric(simAlleleFreq[frqYr==year & frqCat=='pFs-pt',c(3:(nloci+2))])*
as.numeric(simAlleleFreq[frqYr==year & frqCat=='pFi-pt',c(3:(nloci+2))]))
simVar[bsYr==year & bsCat=='sxFsxFi',3]<-
mean(as.numeric(simAlleleFreq[frqYr==year & frqCat=='sxFs-xt',c(3:(nloci+2))])*
as.numeric(simAlleleFreq[frqYr==year & frqCat=='sxFi-xt',c(3:(nloci+2))]))
simVar[bsYr==year & bsCat=='sxFserrFI',3]<-
mean(as.numeric(simAlleleFreq[frqYr==year & frqCat=='sxFs-xt',c(3:(nloci+2))])*
as.numeric(simAlleleFreq[frqYr==year & frqCat=='errFI-errT',c(3:(nloci+2))]))
simVar[bsYr==year & bsCat=='errFSxFi',3]<-
mean(as.numeric(simAlleleFreq[frqYr==year & frqCat=='errFS-errT',c(3:(nloci+2))])*
as.numeric(simAlleleFreq[frqYr==year & frqCat=='sxFi-xt',c(3:(nloci+2))]))
simVar[bsYr==year & bsCat=='errFSerrFI',3]<-
mean(as.numeric(simAlleleFreq[frqYr==year & frqCat=='errFS-errT',c(3:(nloci+2))])*
as.numeric(simAlleleFreq[frqYr==year & frqCat=='errFI-errT',c(3:(nloci+2))]))
simVar[bsYr==year & bsCat=='pFspFb',3]<-
mean(as.numeric(simAlleleFreq[frqYr==year & frqCat=='pFs-pt',c(3:(nloci+2))])*
as.numeric(simAlleleFreq[frqYr==year & frqCat=='pFb-pt',c(3:(nloci+2))]))
simVar[bsYr==year & bsCat=='sxFsxFb',3]<-
mean(as.numeric(simAlleleFreq[frqYr==year & frqCat=='sxFs-xt',c(3:(nloci+2))])*
as.numeric(simAlleleFreq[frqYr==year & frqCat=='sxFb-xt',c(3:(nloci+2))]))
simVar[bsYr==year & bsCat=='sxFserrFB',3]<-
mean(as.numeric(simAlleleFreq[frqYr==year & frqCat=='sxFs-xt',c(3:(nloci+2))])*
as.numeric(simAlleleFreq[frqYr==year & frqCat=='errFB-errT',c(3:(nloci+2))]))
simVar[bsYr==year & bsCat=='errFSxFb',3]<-
mean(as.numeric(simAlleleFreq[frqYr==year & frqCat=='errFS-errT',c(3:(nloci+2))])*
as.numeric(simAlleleFreq[frqYr==year & frqCat=='sxFb-xt',c(3:(nloci+2))]))
simVar[bsYr==year & bsCat=='errFSerrFB',3]<-
mean(as.numeric(simAlleleFreq[frqYr==year & frqCat=='errFS-errT',c(3:(nloci+2))])*
as.numeric(simAlleleFreq[frqYr==year & frqCat=='errFB-errT',c(3:(nloci+2))]))
simVar[bsYr==year & bsCat=='pFipFb',3]<-
mean(as.numeric(simAlleleFreq[frqYr==year & frqCat=='pFi-pt',c(3:(nloci+2))])*
as.numeric(simAlleleFreq[frqYr==year & frqCat=='pFb-pt',c(3:(nloci+2))]))
simVar[bsYr==year & bsCat=='sxFixFb',3]<-
mean(as.numeric(simAlleleFreq[frqYr==year & frqCat=='sxFi-xt',c(3:(nloci+2))])*
as.numeric(simAlleleFreq[frqYr==year & frqCat=='sxFb-xt',c(3:(nloci+2))]))
simVar[bsYr==year & bsCat=='sxFierrFB',3]<-
mean(as.numeric(simAlleleFreq[frqYr==year & frqCat=='sxFi-xt',c(3:(nloci+2))])*
as.numeric(simAlleleFreq[frqYr==year & frqCat=='errFB-errT',c(3:(nloci+2))]))
simVar[bsYr==year & bsCat=='errFIxFb',3]<-
mean(as.numeric(simAlleleFreq[frqYr==year & frqCat=='errFI-errT',c(3:(nloci+2))])*
as.numeric(simAlleleFreq[frqYr==year & frqCat=='sxFb-xt',c(3:(nloci+2))]))
simVar[bsYr==year & bsCat=='errFIerrFB',3]<-
mean(as.numeric(simAlleleFreq[frqYr==year & frqCat=='errFI-errT',c(3:(nloci+2))])*
as.numeric(simAlleleFreq[frqYr==year & frqCat=='errFB-errT',c(3:(nloci+2))]))
#covariance between males and females within a Category
#survivors
simVar[bsYr==year & bsCat=='pMspFs',3]<-
mean(as.numeric(simAlleleFreq[frqYr==year & frqCat=='pMs-pt',c(3:(nloci+2))])*
as.numeric(simAlleleFreq[frqYr==year & frqCat=='pFs-pt',c(3:(nloci+2))]))
simVar[bsYr==year & bsCat=='sxMsxFs',3]<-
mean(as.numeric(simAlleleFreq[frqYr==year & frqCat=='sxMs-xt',c(3:(nloci+2))])*
as.numeric(simAlleleFreq[frqYr==year & frqCat=='sxFs-xt',c(3:(nloci+2))]))
simVar[bsYr==year & bsCat=='sxMserrFS',3]<-
mean(as.numeric(simAlleleFreq[frqYr==year & frqCat=='sxMs-xt',c(3:(nloci+2))])*
as.numeric(simAlleleFreq[frqYr==year & frqCat=='errFS-errT',c(3:(nloci+2))]))
simVar[bsYr==year & bsCat=='errMSxFs',3]<-
mean(as.numeric(simAlleleFreq[frqYr==year & frqCat=='errMS-errT',c(3:(nloci+2))])*
as.numeric(simAlleleFreq[frqYr==year & frqCat=='sxFs-xt',c(3:(nloci+2))]))
simVar[bsYr==year & bsCat=='errMSerrFS',3]<-
mean(as.numeric(simAlleleFreq[frqYr==year & frqCat=='errMS-errT',c(3:(nloci+2))])*
as.numeric(simAlleleFreq[frqYr==year & frqCat=='errFS-errT',c(3:(nloci+2))]))
#imms
simVar[bsYr==year & bsCat=='pMipFi',3]<-
mean(as.numeric(simAlleleFreq[frqYr==year & frqCat=='pMi-pt',c(3:(nloci+2))])*
as.numeric(simAlleleFreq[frqYr==year & frqCat=='pFi-pt',c(3:(nloci+2))]))
simVar[bsYr==year & bsCat=='sxMixFi',3]<-
mean(as.numeric(simAlleleFreq[frqYr==year & frqCat=='sxMi-xt',c(3:(nloci+2))])*
as.numeric(simAlleleFreq[frqYr==year & frqCat=='sxFi-xt',c(3:(nloci+2))]))
simVar[bsYr==year & bsCat=='sxMierrFI',3]<-
mean(as.numeric(simAlleleFreq[frqYr==year & frqCat=='sxMi-xt',c(3:(nloci+2))])*
as.numeric(simAlleleFreq[frqYr==year & frqCat=='errFI-errT',c(3:(nloci+2))]))
simVar[bsYr==year & bsCat=='errMIxFi',3]<-
mean(as.numeric(simAlleleFreq[frqYr==year & frqCat=='errMI-errT',c(3:(nloci+2))])*
as.numeric(simAlleleFreq[frqYr==year & frqCat=='sxFi-xt',c(3:(nloci+2))]))
simVar[bsYr==year & bsCat=='errMIerrFI',3]<-
mean(as.numeric(simAlleleFreq[frqYr==year & frqCat=='errMI-errT',c(3:(nloci+2))])*
as.numeric(simAlleleFreq[frqYr==year & frqCat=='errFI-errT',c(3:(nloci+2))]))
#births
simVar[bsYr==year & bsCat=='pMbpFb',3]<-
mean(as.numeric(simAlleleFreq[frqYr==year & frqCat=='pMb-pt',c(3:(nloci+2))])*
as.numeric(simAlleleFreq[frqYr==year & frqCat=='pFb-pt',c(3:(nloci+2))]))
simVar[bsYr==year & bsCat=='sxMbxFb',3]<-
mean(as.numeric(simAlleleFreq[frqYr==year & frqCat=='sxMb-xt',c(3:(nloci+2))])*
as.numeric(simAlleleFreq[frqYr==year & frqCat=='sxFb-xt',c(3:(nloci+2))]))
simVar[bsYr==year & bsCat=='sxMberrFB',3]<-
mean(as.numeric(simAlleleFreq[frqYr==year & frqCat=='sxMb-xt',c(3:(nloci+2))])*
as.numeric(simAlleleFreq[frqYr==year & frqCat=='errFB-errT',c(3:(nloci+2))]))
simVar[bsYr==year & bsCat=='errMBxFb',3]<-
mean(as.numeric(simAlleleFreq[frqYr==year & frqCat=='errMB-errT',c(3:(nloci+2))])*
as.numeric(simAlleleFreq[frqYr==year & frqCat=='sxFb-xt',c(3:(nloci+2))]))
simVar[bsYr==year & bsCat=='errMBerrFB',3]<-
mean(as.numeric(simAlleleFreq[frqYr==year & frqCat=='errMB-errT',c(3:(nloci+2))])*
as.numeric(simAlleleFreq[frqYr==year & frqCat=='errFB-errT',c(3:(nloci+2))]))
#covariance between males and females in different categories
simVar[bsYr==year & bsCat=='pMspFi',3]<-
mean(as.numeric(simAlleleFreq[frqYr==year & frqCat=='pMs-pt',c(3:(nloci+2))])*
as.numeric(simAlleleFreq[frqYr==year & frqCat=='pFi-pt',c(3:(nloci+2))]))
simVar[bsYr==year & bsCat=='sxMsxFi',3]<-
mean(as.numeric(simAlleleFreq[frqYr==year & frqCat=='sxMs-xt',c(3:(nloci+2))])*
as.numeric(simAlleleFreq[frqYr==year & frqCat=='sxFi-xt',c(3:(nloci+2))]))
simVar[bsYr==year & bsCat=='sxMserrFI',3]<-
mean(as.numeric(simAlleleFreq[frqYr==year & frqCat=='sxMs-xt',c(3:(nloci+2))])*
as.numeric(simAlleleFreq[frqYr==year & frqCat=='errFI-errT',c(3:(nloci+2))]))
simVar[bsYr==year & bsCat=='errMSxFi',3]<-
mean(as.numeric(simAlleleFreq[frqYr==year & frqCat=='errMS-errT',c(3:(nloci+2))])*
as.numeric(simAlleleFreq[frqYr==year & frqCat=='sxFi-xt',c(3:(nloci+2))]))
simVar[bsYr==year & bsCat=='errMSerrFI',3]<-
mean(as.numeric(simAlleleFreq[frqYr==year & frqCat=='errMS-errT',c(3:(nloci+2))])*
as.numeric(simAlleleFreq[frqYr==year & frqCat=='errFI-errT',c(3:(nloci+2))]))
simVar[bsYr==year & bsCat=='pMspFb',3]<-
mean(as.numeric(simAlleleFreq[frqYr==year & frqCat=='pMs-pt',c(3:(nloci+2))])*
as.numeric(simAlleleFreq[frqYr==year & frqCat=='pFb-pt',c(3:(nloci+2))]))
simVar[bsYr==year & bsCat=='sxMsxFb',3]<-
mean(as.numeric(simAlleleFreq[frqYr==year & frqCat=='sxMs-xt',c(3:(nloci+2))])*
as.numeric(simAlleleFreq[frqYr==year & frqCat=='sxFb-xt',c(3:(nloci+2))]))
simVar[bsYr==year & bsCat=='sxMserrFB',3]<-
mean(as.numeric(simAlleleFreq[frqYr==year & frqCat=='sxMs-xt',c(3:(nloci+2))])*
as.numeric(simAlleleFreq[frqYr==year & frqCat=='errFB-errT',c(3:(nloci+2))]))
simVar[bsYr==year & bsCat=='errMSxFb',3]<-
mean(as.numeric(simAlleleFreq[frqYr==year & frqCat=='errMS-errT',c(3:(nloci+2))])*
as.numeric(simAlleleFreq[frqYr==year & frqCat=='sxFb-xt',c(3:(nloci+2))]))
simVar[bsYr==year & bsCat=='errMSerrFB',3]<-
mean(as.numeric(simAlleleFreq[frqYr==year & frqCat=='errMS-errT',c(3:(nloci+2))])*
as.numeric(simAlleleFreq[frqYr==year & frqCat=='errFB-errT',c(3:(nloci+2))]))
simVar[bsYr==year & bsCat=='pMipFb',3]<-
mean(as.numeric(simAlleleFreq[frqYr==year & frqCat=='pMi-pt',c(3:(nloci+2))])*
as.numeric(simAlleleFreq[frqYr==year & frqCat=='pFb-pt',c(3:(nloci+2))]))
simVar[bsYr==year & bsCat=='sxMixFb',3]<-
mean(as.numeric(simAlleleFreq[frqYr==year & frqCat=='sxMi-xt',c(3:(nloci+2))])*
as.numeric(simAlleleFreq[frqYr==year & frqCat=='sxFb-xt',c(3:(nloci+2))]))
simVar[bsYr==year & bsCat=='sxMierrFB',3]<-
mean(as.numeric(simAlleleFreq[frqYr==year & frqCat=='sxMi-xt',c(3:(nloci+2))])*
as.numeric(simAlleleFreq[frqYr==year & frqCat=='errFB-errT',c(3:(nloci+2))]))
simVar[bsYr==year & bsCat=='errMIxFb',3]<-
mean(as.numeric(simAlleleFreq[frqYr==year & frqCat=='errMI-errT',c(3:(nloci+2))])*
as.numeric(simAlleleFreq[frqYr==year & frqCat=='sxFb-xt',c(3:(nloci+2))]))
simVar[bsYr==year & bsCat=='errMIerrFB',3]<-
mean(as.numeric(simAlleleFreq[frqYr==year & frqCat=='errMI-errT',c(3:(nloci+2))])*
as.numeric(simAlleleFreq[frqYr==year & frqCat=='errFB-errT',c(3:(nloci+2))]))
simVar[bsYr==year & bsCat=='pFspMi',3]<-
mean(as.numeric(simAlleleFreq[frqYr==year & frqCat=='pFs-pt',c(3:(nloci+2))])*
as.numeric(simAlleleFreq[frqYr==year & frqCat=='pMi-pt',c(3:(nloci+2))]))
simVar[bsYr==year & bsCat=='sxFsxMi',3]<-
mean(as.numeric(simAlleleFreq[frqYr==year & frqCat=='sxFs-xt',c(3:(nloci+2))])*
as.numeric(simAlleleFreq[frqYr==year & frqCat=='sxMi-xt',c(3:(nloci+2))]))
simVar[bsYr==year & bsCat=='sxFserrMI',3]<-
mean(as.numeric(simAlleleFreq[frqYr==year & frqCat=='sxFs-xt',c(3:(nloci+2))])*
as.numeric(simAlleleFreq[frqYr==year & frqCat=='errMI-errT',c(3:(nloci+2))]))
simVar[bsYr==year & bsCat=='errFSxMi',3]<-
mean(as.numeric(simAlleleFreq[frqYr==year & frqCat=='errFS-errT',c(3:(nloci+2))])*
as.numeric(simAlleleFreq[frqYr==year & frqCat=='sxMi-xt',c(3:(nloci+2))]))
simVar[bsYr==year & bsCat=='errFSerrMI',3]<-
mean(as.numeric(simAlleleFreq[frqYr==year & frqCat=='errFS-errT',c(3:(nloci+2))])*
as.numeric(simAlleleFreq[frqYr==year & frqCat=='errMI-errT',c(3:(nloci+2))]))
simVar[bsYr==year & bsCat=='pFspMb',3]<-
mean(as.numeric(simAlleleFreq[frqYr==year & frqCat=='pFs-pt',c(3:(nloci+2))])*
as.numeric(simAlleleFreq[frqYr==year & frqCat=='pMb-pt',c(3:(nloci+2))]))
simVar[bsYr==year & bsCat=='sxFsxMb',3]<-
mean(as.numeric(simAlleleFreq[frqYr==year & frqCat=='sxFs-xt',c(3:(nloci+2))])*
as.numeric(simAlleleFreq[frqYr==year & frqCat=='sxMb-xt',c(3:(nloci+2))]))
simVar[bsYr==year & bsCat=='sxFserrMB',3]<-
mean(as.numeric(simAlleleFreq[frqYr==year & frqCat=='sxFs-xt',c(3:(nloci+2))])*
as.numeric(simAlleleFreq[frqYr==year & frqCat=='errMB-errT',c(3:(nloci+2))]))
simVar[bsYr==year & bsCat=='errFSxMb',3]<-
mean(as.numeric(simAlleleFreq[frqYr==year & frqCat=='errFS-errT',c(3:(nloci+2))])*
as.numeric(simAlleleFreq[frqYr==year & frqCat=='sxMb-xt',c(3:(nloci+2))]))
simVar[bsYr==year & bsCat=='errFSerrMB',3]<-
mean(as.numeric(simAlleleFreq[frqYr==year & frqCat=='errFS-errT',c(3:(nloci+2))])*
as.numeric(simAlleleFreq[frqYr==year & frqCat=='errMB-errT',c(3:(nloci+2))]))
simVar[bsYr==year & bsCat=='pFipMb',3]<-
mean(as.numeric(simAlleleFreq[frqYr==year & frqCat=='pFi-pt',c(3:(nloci+2))])*
as.numeric(simAlleleFreq[frqYr==year & frqCat=='pMb-pt',c(3:(nloci+2))]))
simVar[bsYr==year & bsCat=='sxFixMb',3]<-
mean(as.numeric(simAlleleFreq[frqYr==year & frqCat=='sxFi-xt',c(3:(nloci+2))])*
as.numeric(simAlleleFreq[frqYr==year & frqCat=='sxMb-xt',c(3:(nloci+2))]))
simVar[bsYr==year & bsCat=='sxFierrMB',3]<-
mean(as.numeric(simAlleleFreq[frqYr==year & frqCat=='sxFi-xt',c(3:(nloci+2))])*
as.numeric(simAlleleFreq[frqYr==year & frqCat=='errMB-errT',c(3:(nloci+2))]))
simVar[bsYr==year & bsCat=='errFIxMb',3]<-
mean(as.numeric(simAlleleFreq[frqYr==year & frqCat=='errFI-errT',c(3:(nloci+2))])*
as.numeric(simAlleleFreq[frqYr==year & frqCat=='sxMb-xt',c(3:(nloci+2))]))
simVar[bsYr==year & bsCat=='errFIerrMB',3]<-
mean(as.numeric(simAlleleFreq[frqYr==year & frqCat=='errFI-errT',c(3:(nloci+2))])*
as.numeric(simAlleleFreq[frqYr==year & frqCat=='errMB-errT',c(3:(nloci+2))]))
#variance for mendelian segregation and family size
#males
simVar[bsYr==year & bsCat=='pMmend',3]<-
mean(as.numeric(simAlleleFreq[frqYr==year & frqCat=='pMmend',c(3:(nloci+2))])^2)
simVar[bsYr==year & bsCat=='sxMmend',3]<-
mean(as.numeric(simAlleleFreq[frqYr==year & frqCat=='sxMmend',c(3:(nloci+2))])^2)
simVar[bsYr==year & bsCat=='errMMEND',3]<-
mean(as.numeric(simAlleleFreq[frqYr==year & frqCat=='errMMEND',c(3:(nloci+2))])^2)
simVar[bsYr==year & bsCat=='pMfam-pt',3]<-
mean(as.numeric(simAlleleFreq[frqYr==year & frqCat=='pMfam-pt',c(3:(nloci+2))])^2)
simVar[bsYr==year & bsCat=='sxMfam-xt',3]<-
mean(as.numeric(simAlleleFreq[frqYr==year & frqCat=='sxMfam-xt',c(3:(nloci+2))])^2)
simVar[bsYr==year & bsCat=='errMFAM-errT',3]<-
mean(as.numeric(simAlleleFreq[frqYr==year & frqCat=='errMFAM-errT',c(3:(nloci+2))])^2)
#females
simVar[bsYr==year & bsCat=='pFmend',3]<-
mean(as.numeric(simAlleleFreq[frqYr==year & frqCat=='pFmend',c(3:(nloci+2))])^2)
simVar[bsYr==year & bsCat=='sxFmend',3]<-
mean(as.numeric(simAlleleFreq[frqYr==year & frqCat=='sxFmend',c(3:(nloci+2))])^2)
simVar[bsYr==year & bsCat=='errFMEND',3]<-
mean(as.numeric(simAlleleFreq[frqYr==year & frqCat=='errFMEND',c(3:(nloci+2))])^2)
simVar[bsYr==year & bsCat=='pFfam-pt',3]<-
mean(as.numeric(simAlleleFreq[frqYr==year & frqCat=='pFfam-pt',c(3:(nloci+2))])^2)
simVar[bsYr==year & bsCat=='sxFfam-xt',3]<-
mean(as.numeric(simAlleleFreq[frqYr==year & frqCat=='sxFfam-xt',c(3:(nloci+2))])^2)
simVar[bsYr==year & bsCat=='errFFAM-errT',3]<-
mean(as.numeric(simAlleleFreq[frqYr==year & frqCat=='errFFAM-errT',c(3:(nloci+2))])^2)
}
names(simVar) <- names(sampleVar)
allVar_tmp <- rbind.data.frame(sampleVar,simVar)
allVar[,(loop+2)] <- allVar_tmp[,3]
names(allVar)[(loop+2)] <- paste("bs",win,sep="")
loop = loop +1
today<-format(Sys.Date(),format="%d%b%Y")
